# CTF - One Cipher - Chap√©u de Palha

import base64

def reverse(key):
    return key[::-1]

def decrypt_text(encrypted_text, key):
    decrypted_text = ''
    key_length = len(key)
    for i, char in enumerate(encrypted_text):
        key_char = key[i % key_length]
        decrypted_char = chr(ord(char) ^ ord(key_char))
        decrypted_text += decrypted_char
    return decrypted_text

def xor_with_number(encrypted_text, number):
    elevated_number = number ** 2
    encrypted_text_xor = ''
    for char in encrypted_text:
        encrypted_char = chr(ord(char) ^ elevated_number % 1114112)
        encrypted_text_xor += encrypted_char
    return encrypted_text_xor

Key = "83b0f13e-794f-11ef-83c6-00155db0496d"
Text = "4YSd4YWZ4YSJ4YSD4YWG4YSE4YS/4YWf4YSF4YWW4YWr4YSF4YW24YSB4YWU4YWE4YWj4YWH4YWW4YSC4YWq4YSE4YWS4YSl4YWx4YWx4YW1"

Decoded_text = base64.b64decode(Text.encode()).decode('utf-8')
Reversed_key = reverse(Key)

for i in range(1, 100):
    result_xor = xor_with_number(Decoded_text, i)
    Decrypt_text = decrypt_text(result_xor, Reversed_key)
    Reverse = reverse(Decrypt_text)
    print(f"Random number: {i} | Decrypted text: {Reverse}", "\n")