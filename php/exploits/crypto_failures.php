# CTF - Decryptify - TryHackMe 
# All exploits in here, choise one and run it in your terminal

<?php # Find Constant Value

function calculate_seed_value($email, $constant_value) {
    $email_length = strlen($email);
    
    $email_hex = hexdec(substr($email, 0, 8));
    
    $seed_value = hexdec($email_length + $constant_value + $email_hex);

    return $seed_value;
}

function brute_force_constant($email, $random) {
    $constant_min = 0;
    $constant_max = 1000000;

    for ($constant_value = $constant_min; $constant_value <= $constant_max; $constant_value++) {
        $seed_value = calculate_seed_value($email, $constant_value);
        
        mt_srand($seed_value);
        
        $generated_random = mt_rand();

        if ($generated_random === $random) {
            echo "Valor constante encontrado: " . $constant_value . "\n";
            return $constant_value;
        }
    }

    echo "Valor constante nÃ£o encontrado no intervalo fornecido.\n";
    return null;
}

$email = "alpha@fake.thm";
$random = 1348337122;

$found_constant = brute_force_constant($email, $random);

?>

###################################################################################

<?php # Find Token

function calculate_seed_value($email, $constant_value) {
    $email_length = strlen($email);
    
    $email_hex = hexdec(substr($email, 0, 8));
    
    $seed_value = hexdec($email_length + $constant_value + $email_hex);

    return $seed_value;
}

$email = "hello@fake.thm";
$constant_value = #find_constant_value_here;

$seed_value = calculate_seed_value($email, $constant_value);
mt_srand($seed_value);
$random = mt_rand();
$find_token = base64_encode($random);

echo "Email: " . $email . "Token encontrado: " . $find_token . "\n";


?>